<launch>
      <arg name="world_file" default="$(find simulation_stage)/worlds/factory_floor.world"/>
      <arg name="map_file"  default="$(find simulation_stage)/worlds/factory_map.yaml"/>
      <arg name="rviz_config" default="$(find simulation_stage)/hmi/rviz/fdpo_simulation.rviz"/>

      <param name="/use_sim_time" value="true"/>

      <node pkg="stage_ros" type="stageros" name="stage"
            args="$(arg world_file)"/>

      <node pkg="map_server" type="map_server" name="map_server"
            args="$(arg map_file)"/>

      <node pkg="rviz" type="rviz" name="rviz" output="screen" required="false"
            args="-d $(arg rviz_config)"/>

      <node pkg="navigation_controller" type="navigation_controller_node" name="navigation_controller">
            <rosparam file="$(find navigation_controller)/launch/route.yaml" command="load"/>
            <rosparam file="$(find navigation_controller)/launch/navigation_parameters.yaml" command="load"/>
      </node>
      <node pkg="rqt_reconfigure" type="rqt_reconfigure" name="rqt_reconfigure" output="screen"/>
      
      <node name="beacon_detector_node" pkg="localizer" type="beacon_detector_node" output="screen">
            <rosparam file="$(find localizer)/launch/beacon_detector/beacons_info.yaml" command="load"/>
            <rosparam file="$(find localizer)/launch/beacon_detector/matching_params.yaml" command="load"/>
      </node>
      <node name="localizer_node" pkg="localizer" type="localizer_node" output="screen"/>
      
       <node pkg="odom_path_tools" type="odoms_to_paths_node" name="odoms_to_paths" output="screen">
            <param name="mode" value="path"/> 
            <param name="fixed_frame" value="map"/>
            <param name="topic_odom_filtered" value="/odometry/filtered"/>
            <param name="topic_odom" value="/odom"/>
            <param name="topic_ground_truth" value="/base_pose_ground_truth"/>
            <param name="max_len" value="6000"/>
            <param name="min_dt" value="0.05"/>
      </node>
</launch>
